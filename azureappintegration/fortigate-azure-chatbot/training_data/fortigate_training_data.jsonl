{"messages": [{"role": "system", "content": "You are an expert FortiGate Azure deployment assistant with deep knowledge of Terraform, Azure networking, and FortiGate security appliances."}, {"role": "user", "content": "How do I deploy a single FortiGate VM in Azure?"}, {"role": "assistant", "content": "To deploy a single FortiGate VM in Azure:\n\n1. **Resource Group**: Create a dedicated resource group\n2. **Virtual Network**: Set up VNet with subnets:\n   - External subnet (public-facing)\n   - Internal subnet (protected resources)\n   - Management subnet (FortiGate management)\n\n3. **Network Security Groups**: Configure NSGs for each subnet\n4. **Public IP**: Assign static public IP for external interface\n5. **FortiGate VM**: Deploy from Azure Marketplace\n6. **Storage Account**: For boot diagnostics and logging\n\n**Terraform Example**:\n```hcl\nresource \"azurerm_virtual_machine\" \"fortigate\" {\n  name                = \"fortigate-vm\"\n  location            = var.location\n  resource_group_name = var.resource_group_name\n  vm_size            = \"Standard_F2s\"\n  \n  storage_image_reference {\n    publisher = \"fortinet\"\n    offer     = \"fortinet_fortigate-vm_v5\"\n    sku       = \"fortinet_fg-vm\"\n    version   = \"latest\"\n  }\n}\n```\n\n**Key Considerations**:\n- Choose appropriate VM size based on throughput requirements\n- Configure proper routing for traffic flow\n- Set up monitoring and logging\n- Implement backup and disaster recovery"}]}
{"messages": [{"role": "system", "content": "You are an expert FortiGate Azure deployment assistant with deep knowledge of Terraform, Azure networking, and FortiGate security appliances."}, {"role": "user", "content": "What's the difference between HA active-passive and active-active?"}, {"role": "assistant", "content": "FortiGate HA deployment modes in Azure:\n\n**Active-Passive HA**:\n- One FortiGate processes traffic (active)\n- Second FortiGate stands by (passive)\n- Automatic failover when active fails\n- Shared virtual IP addresses\n- Session synchronization between units\n- Best for: Stateful applications, session persistence\n\n**Active-Active HA**:\n- Both FortiGates process traffic simultaneously\n- Load balancing across both units\n- Higher throughput and utilization\n- Independent processing of connections\n- Best for: High-throughput environments, stateless applications\n\n**Azure Implementation**:\n- Use Azure Load Balancer for traffic distribution\n- Configure health probes for failover detection\n- Set up route tables for proper traffic flow\n- Implement Azure availability sets/zones for redundancy\n\n**Terraform Configuration**:\n```hcl\nresource \"azurerm_lb\" \"fortigate_lb\" {\n  name                = \"fortigate-lb\"\n  location            = var.location\n  resource_group_name = var.resource_group_name\n  sku                = \"Standard\"\n  \n  frontend_ip_configuration {\n    name                 = \"external\"\n    public_ip_address_id = azurerm_public_ip.lb_pip.id\n  }\n}\n```"}]}
{"messages": [{"role": "system", "content": "You are an expert FortiGate Azure deployment assistant with deep knowledge of Terraform, Azure networking, and FortiGate security appliances."}, {"role": "user", "content": "How do I configure FortiGate with Azure Application Gateway?"}, {"role": "assistant", "content": "Integrating FortiGate with Azure Application Gateway:\n\n**Architecture Overview**:\n- Application Gateway: Layer 7 load balancer (frontend)\n- FortiGate: Security inspection and filtering\n- Backend servers: Protected applications\n\n**Configuration Steps**:\n\n1. **Application Gateway Setup**:\n   - Deploy in dedicated subnet\n   - Configure backend pool pointing to FortiGate internal IPs\n   - Set up health probes for FortiGate availability\n\n2. **FortiGate Configuration**:\n   - Configure virtual IPs for backend services\n   - Set up firewall policies for traffic inspection\n   - Enable SSL inspection if required\n   - Configure load balancing to backend servers\n\n3. **Network Flow**:\n   ```\n   Internet → App Gateway → FortiGate → Backend Servers\n   ```\n\n**Terraform Implementation**:\n```hcl\nresource \"azurerm_application_gateway\" \"main\" {\n  name                = \"fortigate-appgw\"\n  resource_group_name = var.resource_group_name\n  location            = var.location\n\n  sku {\n    name     = \"WAF_v2\"\n    tier     = \"WAF_v2\"\n    capacity = 2\n  }\n\n  backend_address_pool {\n    name = \"fortigate-backend\"\n    ip_addresses = [\n      azurerm_network_interface.fortigate_internal.private_ip_address\n    ]\n  }\n}\n```\n\n**Benefits**:\n- SSL termination at Application Gateway\n- Web Application Firewall (WAF) protection\n- Advanced security inspection by FortiGate\n- High availability and scalability"}]}
{"messages": [{"role": "system", "content": "You are an expert FortiGate Azure deployment assistant with deep knowledge of Terraform, Azure networking, and FortiGate security appliances."}, {"role": "user", "content": "What are the essential Terraform variables for FortiGate deployment?"}, {"role": "assistant", "content": "Essential Terraform variables for FortiGate Azure deployment:\n\n**Core Variables**:\n```hcl\nvariable \"resource_group_name\" {\n  description = \"Name of the Azure resource group\"\n  type        = string\n}\n\nvariable \"location\" {\n  description = \"Azure region for deployment\"\n  type        = string\n  default     = \"East US\"\n}\n\nvariable \"fortigate_vm_size\" {\n  description = \"Size of the FortiGate VM\"\n  type        = string\n  default     = \"Standard_F2s_v2\"\n  validation {\n    condition = contains([\n      \"Standard_F2s_v2\", \"Standard_F4s_v2\", \"Standard_F8s_v2\"\n    ], var.fortigate_vm_size)\n    error_message = \"VM size must be a supported FortiGate size.\"\n  }\n}\n\nvariable \"admin_username\" {\n  description = \"Administrator username for FortiGate\"\n  type        = string\n  default     = \"azureuser\"\n}\n\nvariable \"admin_password\" {\n  description = \"Administrator password for FortiGate\"\n  type        = string\n  sensitive   = true\n}\n```\n\n**Network Variables**:\n```hcl\nvariable \"vnet_address_space\" {\n  description = \"Address space for the virtual network\"\n  type        = list(string)\n  default     = [\"10.0.0.0/16\"]\n}\n\nvariable \"external_subnet_prefix\" {\n  description = \"Address prefix for external subnet\"\n  type        = string\n  default     = \"10.0.1.0/24\"\n}\n\nvariable \"internal_subnet_prefix\" {\n  description = \"Address prefix for internal subnet\"\n  type        = string\n  default     = \"10.0.2.0/24\"\n}\n```\n\n**Security Variables**:\n```hcl\nvariable \"allowed_source_ips\" {\n  description = \"List of allowed source IP addresses\"\n  type        = list(string)\n  default     = [\"0.0.0.0/0\"]\n}\n\nvariable \"enable_accelerated_networking\" {\n  description = \"Enable accelerated networking\"\n  type        = bool\n  default     = true\n}\n```"}]}
{"messages": [{"role": "system", "content": "You are an expert FortiGate Azure deployment assistant with deep knowledge of Terraform, Azure networking, and FortiGate security appliances."}, {"role": "user", "content": "FortiGate VM is not accessible after deployment in Azure"}, {"role": "assistant", "content": "Troubleshooting FortiGate VM accessibility issues:\n\n**Common Causes & Solutions**:\n\n1. **Network Security Group (NSG) Rules**:\n   - Check if management ports are open (443, 22)\n   - Verify source IP restrictions\n   - Ensure proper priority ordering\n\n2. **Public IP Configuration**:\n   - Confirm static public IP is assigned\n   - Check if IP is associated with correct NIC\n   - Verify DNS name resolution\n\n3. **FortiGate Boot Process**:\n   - Check boot diagnostics in Azure portal\n   - Verify VM size meets minimum requirements\n   - Ensure proper storage account configuration\n\n4. **Firewall Policies**:\n   - Default FortiGate blocks all traffic\n   - Create explicit allow policies for management\n   - Check interface assignments\n\n**Diagnostic Commands**:\n```bash\n# Check VM status\naz vm show --resource-group myRG --name fortigate-vm --show-details\n\n# Verify NSG rules\naz network nsg rule list --resource-group myRG --nsg-name fortigate-nsg\n\n# Check public IP\naz network public-ip show --resource-group myRG --name fortigate-pip\n```\n\n**Quick Fix Steps**:\n1. Verify NSG allows HTTPS (443) from your IP\n2. Check public IP is static and assigned\n3. Try accessing via serial console if available\n4. Review Azure activity logs for deployment errors"}]}
